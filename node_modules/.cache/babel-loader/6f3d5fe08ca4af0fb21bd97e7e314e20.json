{"ast":null,"code":"var _jsxFileName = \"/Users/paraiii/Desktop/Todo-about-app-main 2/src/Components/Context/TodoContext.tsx\",\n    _s = $RefreshSig$();\n\nimport { createContext, useCallback, useEffect, useState } from \"react\";\nimport { useSnackbar } from 'notistack';\nimport { AddTask } from \"../API/AddTask\";\nimport { DeleteTask } from \"../API/DeleteTask\";\nimport { GetAllTasks } from \"../API/GetAllTasks\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const initialValue = {\n  todoList: [],\n  loading: false,\n  addTodo: todo => {},\n  removeTodo: id => {},\n  handleCheck: (id, checked) => {},\n  handleDelete: () => {}\n};\nexport const TodoContext = /*#__PURE__*/createContext(initialValue); // const KEY = \"paraiii-todo-list\";\n\nexport const TodoContextProvider = props => {\n  _s();\n\n  const {\n    children\n  } = props; // const storage = window.localStorage;\n  // const storedList = storage.getItem(KEY) || \"[]\"\n  // const [todoList, setTodoList] = useState<TodoItem[]>(JSON.parse(storedList));\n\n  const [todoList, setTodoList] = useState([]);\n  const [loading, setLoading] = useState(false);\n  useEffect(() => {\n    setLoading(true); //     storage.setItem(KEY, JSON.stringify(todoList));\n    // }, [todoList])\n    //每当todolist改变时，把东西存到storage里\n    // AddTask().then(res => {\n    //     //  setTodoList(res.data)\n    //      addTodo(res.data.data) //data里有count和data两部分，不是一个obj\n    // })\n\n    GetAllTasks().then(res => {\n      setLoading(false);\n      const todoDtos = res.data.data;\n      const todoItems = todoDtos.map(todoDto => {\n        const content = JSON.parse(todoDto.description);\n        return { ...content,\n          id: todoDto._id\n        };\n      });\n      setTodoList(todoItems);\n    }); // }, [todoList]); //不能有这个dependency\n  }, []);\n  const buttons = [{\n    message: 'Successfully done the operation.'\n  }];\n  const {\n    enqueueSnackbar\n  } = useSnackbar();\n\n  const addTodo = todo => {\n    const todoDto = {\n      \"description\": JSON.stringify(todo)\n    };\n    setLoading(true);\n    AddTask(todoDto).then(res => {\n      //点击button之后拿到response\n      setLoading(false);\n      todo.id = res.data.data._id;\n      setTodoList([...todoList, todo]);\n\n      const popUp = button => () => {\n        enqueueSnackbar(button.message);\n        return buttons.map(button => {\n          /*#__PURE__*/\n          _jsxDEV(\"button\", {\n            onClick: popUp(button),\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              children: \"success\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 21\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 17\n          }, this);\n        });\n      };\n    });\n  };\n\n  const removeTodo = id => {\n    DeleteTask(id).then(res => {\n      setTodoList(todoList.filter(item => {\n        return item.id !== id;\n      }));\n    });\n  }; // const removeTodos = (ids: string): void => {\n  //     Promise.all(\n  //         ids.map(id => DeleteTask(id))\n  //     ).then ((values) =>{\n  //         console.log(values);\n  //     }\n  //     )\n  // }\n\n\n  const handleCheck = useCallback((id, checked) => {\n    const modifiedTodoList = todoList.map(todoItem => {\n      if (todoItem.id === id) {\n        todoItem.checked = !todoItem.checked;\n      }\n\n      return todoItem;\n    });\n    setTodoList(modifiedTodoList);\n  }, [todoList]);\n  const handleDelete = useCallback(() => {\n    const filteredTodoList = todoList.filter(todoItem => todoItem.checked === false);\n    debugger;\n    setTodoList(filteredTodoList);\n  }, [todoList]);\n  const values = {\n    todoList: todoList,\n    loading: loading,\n    addTodo: addTodo,\n    removeTodo: removeTodo,\n    handleCheck: handleCheck,\n    handleDelete: handleDelete\n  };\n  return /*#__PURE__*/_jsxDEV(TodoContext.Provider, {\n    value: values,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 133,\n    columnNumber: 9\n  }, this);\n};\n\n_s(TodoContextProvider, \"F1ErphikbcwQ+1faPKmkV2geUe4=\", false, function () {\n  return [useSnackbar];\n});\n\n_c = TodoContextProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"TodoContextProvider\");","map":{"version":3,"sources":["/Users/paraiii/Desktop/Todo-about-app-main 2/src/Components/Context/TodoContext.tsx"],"names":["createContext","useCallback","useEffect","useState","useSnackbar","AddTask","DeleteTask","GetAllTasks","initialValue","todoList","loading","addTodo","todo","removeTodo","id","handleCheck","checked","handleDelete","TodoContext","TodoContextProvider","props","children","setTodoList","setLoading","then","res","todoDtos","data","todoItems","map","todoDto","content","JSON","parse","description","_id","buttons","message","enqueueSnackbar","stringify","popUp","button","filter","item","modifiedTodoList","todoItem","filteredTodoList","values"],"mappings":"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","sourcesContent":["import { createContext, useCallback, useEffect, useState } from \"react\";\nimport { useSnackbar } from 'notistack';\nimport { AddTask } from \"../API/AddTask\";\nimport { DeleteTask } from \"../API/DeleteTask\";\nimport { GetAllTasks } from \"../API/GetAllTasks\";\nimport { TodoDto, TodoItem } from \"../types\";\n\ninterface TodoContextProp {\n    children: any;\n    value: TodoContextValue;\n}\n\nexport interface TodoContextValue {\n    todoList: TodoItem[];\n    loading: boolean;\n    addTodo: (todo: TodoItem) => void;\n    removeTodo: (id: string) => void;\n    handleCheck: (id: string, checked: boolean) => void;\n    handleDelete: () => void;\n}\nexport const initialValue: TodoContextValue = {\n    todoList: [],\n    loading: false,\n    addTodo: (todo:TodoItem)=>{},\n    removeTodo: (id: string) => {},\n    handleCheck: (id: string, checked: boolean) => {},\n    handleDelete: () => {},\n}\n\nexport const TodoContext = createContext(initialValue);\n// const KEY = \"paraiii-todo-list\";\n\nexport const TodoContextProvider = (props: TodoContextProp) => {\n    const {children} = props;    \n    // const storage = window.localStorage;\n    // const storedList = storage.getItem(KEY) || \"[]\"\n    // const [todoList, setTodoList] = useState<TodoItem[]>(JSON.parse(storedList));\n    const [todoList, setTodoList] = useState<TodoItem[]>([]);\n    const [loading, setLoading] = useState<boolean>(false);      \n\n    useEffect (() => {\n        setLoading(true);\n    //     storage.setItem(KEY, JSON.stringify(todoList));\n    // }, [todoList])\n        //每当todolist改变时，把东西存到storage里\n        // AddTask().then(res => {\n        //     //  setTodoList(res.data)\n        //      addTodo(res.data.data) //data里有count和data两部分，不是一个obj\n        // })\n        GetAllTasks().then(res => {\n            setLoading(false);\n            const todoDtos = res.data.data;\n            const todoItems = todoDtos.map((todoDto: TodoDto) => {\n                const content: Partial<TodoItem> = JSON.parse(todoDto.description)\n                return { ...content,id: todoDto._id}\n            })\n            setTodoList(todoItems)\n       })\n    // }, [todoList]); //不能有这个dependency\n    }, []);\n    const buttons = [\n        { message: 'Successfully done the operation.' },\n    ];\n    const { enqueueSnackbar } = useSnackbar();\n\n    const addTodo = (todo: TodoItem): void => {\n        const todoDto: Partial<TodoDto> = {\n            \"description\": JSON.stringify(todo)\n        }; \n        setLoading(true);\n        AddTask(todoDto).then(res => { //点击button之后拿到response\n            setLoading(false);\n            todo.id = res.data.data._id\n            setTodoList([...todoList, todo]);\n\n        const popUp = (button: any) => () => {\n            enqueueSnackbar(button.message);\n            return (buttons.map((button) => {\n                <button onClick={popUp(button)}>\n                    <button>success</button>\n                </button>\n            }))\n        }\n        });\n    };  \n    \n    const removeTodo = (id: string): void => {\n        DeleteTask(id).then(res => {\n            setTodoList (\n                todoList.filter((item)=> {\n                    return item.id !== id;\n                })\n            );\n        })\n    };\n\n    // const removeTodos = (ids: string): void => {\n    //     Promise.all(\n    //         ids.map(id => DeleteTask(id))\n    //     ).then ((values) =>{\n    //         console.log(values);\n    //     }\n            \n    //     )\n    // }\n    \n    const handleCheck = useCallback ((id:string, checked: boolean) => {\n        const modifiedTodoList = todoList.map((todoItem) => {\n          if (todoItem.id === id) {\n            todoItem.checked = !todoItem.checked;\n          }\n          return todoItem;\n        });\n        setTodoList(modifiedTodoList);\n    }, [todoList]);\n\n    const handleDelete = useCallback (() => {\n        const filteredTodoList = todoList.filter((todoItem) => todoItem.checked === false);\n        debugger\n        setTodoList(filteredTodoList);\n    }, [todoList]);\n\n    const values: TodoContextValue = {\n        todoList: todoList,\n        loading: loading,\n        addTodo: addTodo,\n        removeTodo: removeTodo,\n        handleCheck: handleCheck,\n        handleDelete: handleDelete,\n    };\n\n    return (\n        <TodoContext.Provider value={values}>\n            {children}\n        </TodoContext.Provider>\n    );\n}\n\n"]},"metadata":{},"sourceType":"module"}